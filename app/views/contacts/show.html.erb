

<div class='user-id' data-id="<%= @contact.user.id %>"></div>
<div class='contact-id' data-id="<%= @contact.id %>"></div>


<div id='top'>


	<h1><%= @contact.first_name %> <%= @contact.last_name %></h1>

	<div class='details-container'>
		<h3>WORKPLACE: <%= @contact.workplace %></h3>
		<h3>EMAIL: <%= @contact.email %></h3>
		<h3>PHONE: <%= @contact.phone %></h3>


		<div id='contact_reference'></div>
		<div id='reference-btn'></div>


	   <td><%= link_to "Edit", edit_user_contact_path(@contact.user, @contact) %></td>
	    <td><%= link_to "Delete", user_contact_path(@contact.user, @contact), :method => :delete %></td>

	</div>

</div>


<div id='mid'>
      
     <div class='col-4'></div>

    <div id='jobs' class='col-4'>
        <h2>LINKED JOBS</h2>

        <div class='linked-items'>
            <% if @contact.jobs.length > 0 %>
                <%= render partial: "jobs/job", collection: @contact.jobs || "No Linked Jobs" %>
            <% else %>
                <h3>No linked jobs</h3>
            <% end %>
        </div>

    </div>


    <div id='tasks' class='col-4'>
        <h2>TASKS</h2>

        <div class='linked-items'>
            <% if @contact.tasks.length > 0 %>
                <%= render partial: "tasks/task", collection: @contact.tasks || "No Linked Tasks" %>
            <% else %>
                <h3>No linked tasks</h3>
            <% end %>
        </div>

    </div>

     <div class='col-4'></div>

</div>





<script>



$(document).ready(function () {
	user_id = $(".user-id").data("id")
	contact_id = $(".contact-id").data("id")

	$.get(`/users/${user_id}/contacts/${contact_id}.json`, function(data) {
		contact = new Contact(data, user_id)

	    displayRefDetails(contact)
		buttonRefFunc(contact)

	});
})



const buttonRefFunc = function(contact) {
	$('#add-reference').on('click', function() {
	    $.get(`/users/${user_id}/contacts/${contact_id}/add_reference?q=${!contact.reference}`, function(data) {
	    })
	})
}



const displayRefDetails = function (contact) {
	$('#contact_reference').append(contact.referenceString())
	$('#reference-btn').append(contact.referenceButton())
}



var clicks = 0

$(function () {

  $("i.task").on('click', function() {
    var id = this.id
    console.log('task')

  	if (clicks % 2 == 0) {
	    $('.task.'+id).css('display', 'block')
    	clicks++
	}
	else {
		$('.task.'+id).css('display', 'none')
		clicks++
	} 
  });

});



var clicks = 0

$(function () {

  $("i.job").on('click', function() {
    var id = this.id
    console.log('job')

  	if (clicks % 2 == 0) {
	    $('.job.'+id).css('display', 'block')
    	clicks++
	}
	else {
		$('.job.'+id).css('display', 'none')
		clicks++
	} 
  });

});





</script>


















